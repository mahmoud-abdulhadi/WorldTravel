!function(){"use strict";function t(t,e=0){if(t&&t.length>0){var o=_.map(t,function(t){return{lat:t.latitude,long:t.longitude,info:t.name}});return travelMap.createMap({stops:o,selector:"#map",currentStop:e,initialZoom:3})}}angular.module("app-trips").controller("tripEditorController",function(e,o){var n=this;n.tripName=e.tripName,n.stops=[],n.input=document.getElementById("name");new google.maps.places.Autocomplete(n.input);n.errorMessage="",n.isBusy=!0,n.newStop={};var s="/api/trips/"+n.tripName+"/stops";o.get(s).then(function(e){angular.copy(e.data,n.stops);t(n.stops)},function(t){n.errorMessage="Failed to load stops "}).finally(function(){n.isBusy=!1}),n.addStop=function(){n.isBusy=!0,o.post(s,n.newStop).then(function(e){n.stops.push(e.data),t(n.stops),n.newStop={}},function(t){n.errorMessage="Failed to add new stop"}).finally(function(){n.isBusy=!1})},n.deleteStop=function(e){confirm("Are You Sure,You want to remove "+e.name+" Stop?")&&(n.isBusy=!0,n.errorMessage="",o.get("/api/trips/"+encodeURI(n.tripName)+"/stops/delete/"+encodeURI(e.name)).then(function(){o.get(s).then(function(e){angular.copy(e.data,n.stops);t(n.stops)},function(t){n.errorMessage="Failed to load stops "}).finally(function(){n.isBusy=!1})},function(){n.errorMessage="Failed to Delete The Stop"}).finally(function(){n.isBusy=!1}))},n.setCurrent=function(e){var o=n.stops.indexOf(e);t(n.stops,o)}})}();